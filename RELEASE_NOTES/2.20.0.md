<!-- THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY. -->

# Fluid Framework v2.20.0

## Contents

- [üêõ Bug Fixes](#-bug-fixes)
- [‚ö†Ô∏è Deprecations](#Ô∏è-deprecations)
  - [Deprecation Notice: Events Interfaces Migrated to `@fluidframework/core-interfaces` (#23313)](#deprecation-notice-events-interfaces-migrated-to-fluidframeworkcore-interfaces-23313)
- [Legacy API Changes](#legacy-api-changes)
  - [MockLogger has been removed from the alpha+legacy API surface (#23010)](#mocklogger-has-been-removed-from-the-alphalegacy-api-surface-23010)
  - [Remove deprecated Merge-Tree and SharedString ISegment members (#23448)](#remove-deprecated-merge-tree-and-sharedstring-isegment-members-23448)
  - [IContainerRuntimeOptions.flushMode has been removed (#23337)](#icontainerruntimeoptionsflushmode-has-been-removed-23337)
  - [ContainerRuntime class is no longer exported (#23341)](#containerruntime-class-is-no-longer-exported-23341)
  - [Replace 'any' in return type for several APIs (#23238)](#replace-any-in-return-type-for-several-apis-23238)
  - [Removed SummarizerStopReason, ISummarizeEventProps, and ISummarizerEvents (#23483)](#removed-summarizerstopreason-isummarizeeventprops-and-isummarizerevents-23483)

## üêõ Bug Fixes

## ‚ö†Ô∏è Deprecations

### Deprecation Notice: Events Interfaces Migrated to `@fluidframework/core-interfaces` ([#23313](https://github.com/microsoft/FluidFramework/issues/23313))

The following interfaces and types are now deprecated in `@fluidframework/tree`. It is recommended to import them from either `@fluidframework/core-interfaces` or `fluid-framework`.

- Listeners
- IsListener
- Listenable
- Off

These deprecated interfaces are planned for removal from `@fluidframework/tree` package in Fluid Framework 3.0 release.

#### Change details

Commit: [`69a755e`](https://github.com/microsoft/FluidFramework/commit/69a755ebd76db36ffd4638d331062f96ec4c0648)

Affected packages:

- @fluidframework/tree

[‚¨ÜÔ∏è Table of contents](#contents)

## Legacy API Changes

### MockLogger has been removed from the alpha+legacy API surface ([#23010](https://github.com/microsoft/FluidFramework/issues/23010))

The `MockLogger` class previously exposed in the alpha+legacy API surface of `@fluidframework/telemetry-utils` has been removed. No replacement is provided, as this class was only intended for use in testing scenarios, and should be trivial to re-implement in any codebase that still uses it.

#### Change details

Commit: [`32ff6b9`](https://github.com/microsoft/FluidFramework/commit/32ff6b9c34be15636adc316a6c76e1755749e06e)

Affected packages:

- @fluidframework/telemetry-utils

[‚¨ÜÔ∏è Table of contents](#contents)

### Remove deprecated Merge-Tree and SharedString ISegment members ([#23448](https://github.com/microsoft/FluidFramework/issues/23448))

The current ISegment interface over-exposes a number of properties which do not have an external use case, and any external usage could result in damage to the underlying merge-tree including data corruption. [In Fluid Framework release 2.12.0 these properties and associated types were deprecated.](https://github.com/microsoft/FluidFramework/blob/main/RELEASE_NOTES/2.12.0.md#merge-tree-and-sharedstring-isegment-deprecations-23323)

The only use case that will continue to be supported is determining if a segment is removed. For this purpose we've added the free function `segmentIsRemoved(segment: ISegment): boolean`.

For example, checking if a segment is not removed would change as follows:

```diff
- if(segment.removedSeq === undefined){
+ if(!segmentIsRemoved(segment)){
```

The following properties are removed from ISegment and its implementations:

- clientId
- index
- localMovedSeq
- localRefs
- localRemovedSeq
- localSeq
- movedClientsIds
- movedSeq
- movedSeqs
- ordinal
- removedClientIds
- removedSeq
- seq
- wasMovedOnInsert

Additionally, the following types are also removed:

- IMergeNodeCommon
- IMoveInfo
- IRemovalInfo
- LocalReferenceCollection

#### Change details

Commit: [`e98574f`](https://github.com/microsoft/FluidFramework/commit/e98574fc625bea7ebce6d79284f32556aaec1c50)

Affected packages:

- @fluidframework/merge-tree
- @fluidframework/sequence

[‚¨ÜÔ∏è Table of contents](#contents)

### IContainerRuntimeOptions.flushMode has been removed ([#23337](https://github.com/microsoft/FluidFramework/issues/23337))

See [2.12.0 release note](https://github.com/microsoft/FluidFramework/releases/tag/client_v2.12.0#user-content-icontainerruntimeoptionsflushmode-is-now-deprecated-23288)

#### Change details

Commit: [`fe8279c`](https://github.com/microsoft/FluidFramework/commit/fe8279c774fcc3c4805b49ce4f64d0e03a64c39b)

Affected packages:

- @fluidframework/container-runtime

[‚¨ÜÔ∏è Table of contents](#contents)

### ContainerRuntime class is no longer exported ([#23341](https://github.com/microsoft/FluidFramework/issues/23341))

Use `IContainerRuntime` to replace type usages and use the free function `loadContainerRuntime` to replace usages of the static method `ContainerRuntime.loadRuntime`.

See the [deprecation release note](https://github.com/microsoft/FluidFramework/releases/tag/client_v2.12.0#user-content-the-containerruntime-class-is-now-deprecated-23331) for more details.

#### Change details

Commit: [`61ba06a`](https://github.com/microsoft/FluidFramework/commit/61ba06aa9881c30ffeeedcaaede9c5a1a0c81abd)

Affected packages:

- @fluidframework/aqueduct
- @fluid-experimental/attributor
- @fluidframework/container-runtime
- @fluidframework/test-utils

[‚¨ÜÔ∏è Table of contents](#contents)

### Replace 'any' in return type for several APIs ([#23238](https://github.com/microsoft/FluidFramework/issues/23238))

To improve type safety of the Fluid Framework legacy+alpha API surface, we're moving away from using the `any` type in favor of `unknown`.

We mostly expect that any changes required in consumers of these APIs will be limited to having to provide explicit types when calling any of the APIs whose return value changed to `unknown`, like `IFluidSerializer.parse()`.

So code that looked like this:

```typescript
// 'myVariable' ended up typed as 'any' here and TypeScript would not do any type-safety checks on it.
const myVariable = this.serializer.parse(stringHeader);
```

Will now have to look like this:

```typescript
// Do this if you know the type of the object you expect to get back.
const myVariable = this.serializer.parse(stringHeader) as MyType;

// Alternatively, this will maintain current behavior but also means no type-safety checks will be done by TS.
// const myVariable = this.serializer.parse(stringHeader) as any;
```

The appropriate type will depend on what the calling code is doing and the objects it expects to be dealing with.

We further encourage consumers of any of these APIs to add runtime checks to validate that the returned object actually matches the expected type.

The list of affected APIs is as follows:

- `IFluidSerializer.encode(...)` now takes `value: unknown` instead of `value: any` and returns `unknown` instead of `any`.
- `IFluidSerializer.decode(...)` now takes `input: unknown` instead of `input: any` and returns `unknown` instead of `any`.
- `IFluidSerializer.stringify(...)` now takes `value: unknown` instead of `value: any`.
- `IFluidSerializer.parse(...)` now returns `unknown` instead of `any`.
- `SharedObjectCore.applyStashedOps(...)` now takes `content: unknown` instead of `content: any`.
- `SharedObjectCore.rollback(...)` now takes `content: unknown` instead of `content: any`.
- `SharedObjectCore.submitLocalMessage(...)` now takes `content: unknown` instead of `content: any`.
- `SharedObjectCore.reSubmitCore(...)` now takes `content: unknown` instead of `content: any`.
- In `SharedObjectCore.newAckBasedPromise<T>(...)` the `executor` parameter now takes `reject: (reason?: unknown)` instead of `reject: (reason?: any)`.
- `makeHandlesSerializable(...)` now returns `unknown` instead of `any`.
- `parseHandles(...)` now returns `unknown` instead of `any`.

Additionally, the following APIs were never designed to return a value and have thus been updated to return `void` instead of `any`:

- `SharedObjectCore.processCore(...)`.
- `SharedObjectCore.onDisconnect(...)`

#### Change details

Commit: [`0783a31`](https://github.com/microsoft/FluidFramework/commit/0783a317317647e8881ec717a6f85c531cdbc956)

Affected packages:

- @fluidframework/shared-object-base

[‚¨ÜÔ∏è Table of contents](#contents)

### Removed SummarizerStopReason, ISummarizeEventProps, and ISummarizerEvents ([#23483](https://github.com/microsoft/FluidFramework/issues/23483))

`SummarizerStopReason`, `ISummarizeEventProps`, and `ISummarizerEvents` have all been removed from the `"@fluidframework/container-runtime"` package. Please migrate all uses of these APIs to their respective copies in the `"@fluidframework/container-runtime-definitions"` package.

#### Change details

Commit: [`6666d49`](https://github.com/microsoft/FluidFramework/commit/6666d496e63031026cdedee98c24bb59fa79edcf)

Affected packages:

- @fluidframework/container-runtime

[‚¨ÜÔ∏è Table of contents](#contents)

### üõ†Ô∏è Start Building Today!

Please continue to engage with us on GitHub [Discussion](https://github.com/microsoft/FluidFramework/discussions) and [Issue](https://github.com/microsoft/FluidFramework/issues) pages as you adopt Fluid Framework!
